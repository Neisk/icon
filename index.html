<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Nisc | æ”¶è—åˆ†äº«</title>
<style>
:root{
  --bg:#0d0d0d;
  --text:#f5f5f5;
  --muted:#888;
  --accent:#00b7ff;
  --card:#1a1a1a;
}
*{box-sizing:border-box}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;
  display:flex;
  flex-direction:column;
  min-height:100vh;
  align-items:center;
  padding:40px 20px 120px;
}
h1{font-size:28px;font-weight:600;margin-bottom:20px;text-align:center;color:var(--accent);}
h2{font-size:22px;margin:30px 0 15px;color:var(--accent);}
.search-box{
  margin-bottom:20px;
  display:flex;
  justify-content:center;
}
.search-box input{
  padding:8px 12px;
  width:300px;
  border-radius:6px;
  border:none;
  outline:none;
  font-size:14px;
}
.gallery{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:24px;
  width:100%;
  max-width:1100px;
}
.card{
  background:var(--card);
  border-radius:16px;
  overflow:hidden;
  box-shadow:0 0 20px rgba(255,255,255,0.06);
  transition:transform .2s ease,box-shadow .2s ease;
  cursor:pointer;
  padding:10px;
  display:flex;
  flex-direction:column;
  align-items:center;
  text-align:center;
}
.card:hover{transform:translateY(-4px);box-shadow:0 0 25px rgba(255,255,255,0.1);}
.card img, .card video{width:100%;height:160px;object-fit:cover;border-radius:10px;}
.card a{text-decoration:none;color:var(--text);margin-top:8px;font-size:14px;word-break:break-all;}
footer{
  padding:20px;
  color:#666;
  font-size:12px;
  text-align:center;
  width:100%;
  position:fixed;
  bottom:0;
  left:0;
  background:rgba(15,15,15,0.9);
  backdrop-filter:blur(10px);
}
.pagination{
  margin-top:20px;
  display:flex;
  gap:6px;
  flex-wrap:wrap;
  justify-content:center;
}
.pagination button{
  padding:6px 12px;
  background:var(--card);
  color:var(--text);
  border:none;
  border-radius:6px;
  cursor:pointer;
  transition:background .2s;
}
.pagination button:hover{background:var(--accent);color:#000;}
.pagination button.active{background:var(--accent);color:#000;font-weight:bold;}
.pagination button:disabled{opacity:.5;cursor:not-allowed;}

/* è§†é¢‘å¼¹çª— */
.player-modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.8);
  justify-content:center;
  align-items:center;
  z-index:200;
}
.player-modal.active{display:flex;}
.player{
  max-width:90%;
  width:800px;
  border-radius:16px;
  overflow:hidden;
  background:#000;
  box-shadow:0 0 30px rgba(255,255,255,0.1);
}
.close-btn{
  position:absolute;
  top:30px;
  right:40px;
  font-size:28px;
  color:#fff;
  cursor:pointer;
  font-weight:300;
}
</style>
</head>
<body>
<h1>ğŸï¸ Nisc å¤šåª’ä½“ç”»å»Š</h1>

<div class="search-box">
  <input type="text" id="searchInput" placeholder="æœç´¢è§†é¢‘æˆ–æ–‡ä»¶åç§°..." />
</div>

<h2>è§†é¢‘åˆ†äº«</h2>
<div class="gallery" id="videoGallery"></div>
<div class="pagination" id="videoPagination"></div>

<h2>æ–‡ä»¶åˆ†äº«</h2>
<div class="gallery" id="fileGallery"></div>
<div class="pagination" id="filePagination"></div>

<!-- è§†é¢‘å¼¹çª— -->
<div class="player-modal" id="playerModal">
  <span class="close-btn" id="closeBtn">Ã—</span>
  <div class="player">
    <video id="videoPlayer" controls playsinline preload="metadata" width="100%"></video>
  </div>
</div>

<footer>Â© 2025 Nisc Â· Powered by GitHub Pages + jsDelivr</footer>

<script>
const videoFolder="mp4";
const fileFolder="share";
const videoGallery=document.getElementById("videoGallery");
const fileGallery=document.getElementById("fileGallery");
const videoPaginationEl=document.getElementById("videoPagination");
const filePaginationEl=document.getElementById("filePagination");
const searchInput=document.getElementById("searchInput");
const pageSize=6;
let videoFiles=[], fileFiles=[];
let videoPage=1, filePage=1;

// å¼¹çª—å…ƒç´ 
const modal=document.getElementById("playerModal");
const videoPlayer=document.getElementById("videoPlayer");
const closeBtn=document.getElementById("closeBtn");
closeBtn.addEventListener("click",closeModal);
modal.addEventListener("click",(e)=>{ if(e.target===modal) closeModal(); });
function closeModal(){ modal.classList.remove("active"); videoPlayer.pause(); videoPlayer.src=""; }

// åŠ è½½æ–‡ä»¶
async function loadFiles(){
  const vRes = await fetch(`https://api.github.com/repos/Neisk/icon/contents/${videoFolder}`);
  const vData = await vRes.json();
  const fRes = await fetch(`https://api.github.com/repos/Neisk/icon/contents/${fileFolder}`);
  const fData = await fRes.json();

  videoFiles = vData.filter(f=>/\.(mp4|mov)$/i.test(f.name)).map(f=>({
    name:f.name,
    url:`https://cdn.jsdelivr.net/gh/Neisk/icon@main/${videoFolder}/${encodeURIComponent(f.name)}`,
    thumb:`https://cdn.jsdelivr.net/gh/Neisk/icon@main/${videoFolder}/thumbnails/${encodeURIComponent(f.name)}.jpg`
  }));

  fileFiles = fData.map(f=>({
    name:f.name,
    url:`https://cdn.jsdelivr.net/gh/Neisk/icon@main/${fileFolder}/${encodeURIComponent(f.name)}`
  }));

  renderVideoPage(videoPage);
  renderFilePage(filePage);
}

// æœç´¢è¿‡æ»¤
function filterFiles(keyword){
  const lower = keyword.toLowerCase();
  return {
    videos: videoFiles.filter(f=>f.name.toLowerCase().includes(lower)),
    files: fileFiles.filter(f=>f.name.toLowerCase().includes(lower))
  };
}

// æ¸²æŸ“è§†é¢‘ç”»å»Š
function renderVideoPage(page, filteredList=null){
  const list = filteredList || videoFiles;
  videoGallery.innerHTML='';
  const start=(page-1)*pageSize;
  const end=start+pageSize;
  const pageFiles=list.slice(start,end);
  pageFiles.forEach(f=>{
    const card=document.createElement('div');
    card.className='card';
    card.innerHTML=`<img src="${f.thumb}" alt="${f.name}"><a>${f.name}</a>`;
    card.addEventListener("click",()=>{
      videoPlayer.src=f.url;
      modal.classList.add("active");
      videoPlayer.play();
    });
    videoGallery.appendChild(card);
  });
  renderPagination(videoPaginationEl,list.length,videoPage,(p)=>{ videoPage=p; renderVideoPage(videoPage, list); });
}

// æ¸²æŸ“æ–‡ä»¶ç”»å»Šï¼ˆæ–‡å­—åˆ—è¡¨ï¼‰
function renderFilePage(page, filteredList=null){
  const list = filteredList || fileFiles;
  fileGallery.innerHTML='';
  const start=(page-1)*pageSize;
  const end=start+pageSize;
  const pageFiles=list.slice(start,end);
  pageFiles.forEach(f=>{
    const card=document.createElement('div');
    card.className='card';
    card.style.height="auto";
    card.style.padding="10px 20px";
    card.innerHTML=`<a href="${f.url}" target="_blank">${f.name}</a>`;
    fileGallery.appendChild(card);
  });
  renderPagination(filePaginationEl,list.length,filePage,(p)=>{ filePage=p; renderFilePage(filePage, list); });
}

// é€šç”¨åˆ†é¡µæ¸²æŸ“
function renderPagination(container,totalItems,current,callback){
  container.innerHTML='';
  const totalPages=Math.ceil(totalItems/pageSize);
  const createBtn=(text,page,active=false,disabled=false)=>{
    const btn=document.createElement("button");
    btn.textContent=text;
    if(active) btn.classList.add("active");
    btn.disabled = disabled;
    btn.addEventListener("click",()=>{ callback(page); });
    return btn;
  };
  container.appendChild(createBtn("ä¸Šä¸€é¡µ",current-1,false,current===1));
  for(let i=1;i<=totalPages;i++) container.appendChild(createBtn(i,i,current===i));
  container.appendChild(createBtn("ä¸‹ä¸€é¡µ",current+1,false,current===totalPages));
}

// æœç´¢è¾“å…¥äº‹ä»¶
searchInput.addEventListener("input",()=>{
  videoPage=1; filePage=1;
  const filtered=filterFiles(searchInput.value);
  renderVideoPage(videoPage, filtered.videos);
  renderFilePage(filePage, filtered.files);
});

// åˆå§‹åŒ–
loadFiles();
</script>
</body>
</html>
